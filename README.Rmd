---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r echo=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "figures/"
)
options(width = 100)
library(Rpriori)
```
[![Build Status](https://travis-ci.org/TimToebrock/Rpriori.svg?branch=master)](https://travis-ci.org/TimToebrock/Rpriori)


# Rpriori

The goal of `Rpriori` is to create association rules of type X=>Y by using the Apriori algorithm. For a more detailed demonstration of how the package works please consider the examples.R file in the examples folder. This `README` only covers the most important features.

## Installation

You can install `Rpriori` from github with:

```{r gh-installation, eval = FALSE}
# install.packages("devtools")
devtools::install_github("TimToebrock/Rpriori")
```

## Example: Creating association rules

Let's say we would like to mine association rules based on the `Groceries` dataset with the 
`Rpriori` package. Let's first get a rough overview over the dataset. To do so we could take a look
the `summary()` function of Rpriori.

```{r}
summary(Groceries)
```

Interesting! We have 9835 transactions recorded with a total of 169 items. With a density of 0.026
the average basket does have 4 items in it. That seems realistic. Let's try to find some frequent
items with the `FindFrequentItemsets()` function of `Rpriori`!

```{r}
Frequent <- FindFrequentItemsets(Groceries, minsupport = 0.1)
show(Frequent)
```

We see that there are some really frequent items that occur in one out of ten transactions! What are
these items? We can take a closer look at the items by using the `print()` function.

```{r}
print(Frequent)
```
Does not even seem that unhealthy! Can we already find association rules based on this support value?
Lets try out the `AssociationRules()` function.

```{r}
AssociationRules(Groceries, 0.1)
```

Unfortunately not. Lets try another support value and set the minimal confidence to 0.2.

```{r}
Rules <- AssociationRules(Groceries, minsupport = 0.01, minconfidence = 0.2)
show(Rules)
```
Wow! We found our first Association rules. In the next example we are going to look a little bit
closer at them!

## Example: Inspecting data

To get summary statistics on the rules simply call `summary()`
```{r}
summary(Rules)
```

If you want to take a look at the underlying data used in rule creation there are multiple ways. One way is to use the `extract` function:
```{r}
Frequent <- extract(Rules)
summary(Frequent)
```
This extracts the frequent itemsets used to calculate association rules. You can also create a frequent itemmatrix directly:
```{r}
Frequent2 <- FindFrequentItemsets(Groceries, 0.01)
Frequent2
```
Since frequent item-set generation takes a lot longer than rule creation, it might be better to create a frequent item matrix first, and then use `AssociationRules()` to calculate rules.

```{r}
fRules <- AssociationRules(Groceries, Frequent, minsupport = 0.03, minconfidence = 0.4)
```
In this case `AssociationRules` won't need to recalculate the frequent item-sets if you do not lower the support threshold.

If you want to take a look at the transactions matrix used to calculate the frequent items you need to create a `TAMatrix` object first:
```{r}
Transactions <- makeTAMatrix(Groceries)
summary(Transactions)
```

## Example: Visualizing data with `plot()` or `qplot()`

All classes come with base plotting and `ggplot2` methods. Both `plot()` and `qplot()` only need to be supplied a valid object to work, however `qplot()` is more flexible and can sometimes be supplied with additional arguments like `col`or `alpha`.

###Plotting transactions
```{r}
plot(Transactions)
qplot(Transactions)
```

###Plotting frequent items
```{r}
plot(Frequent)
qplot(Frequent, type = "scatter", col = "red", alpha = 0.1)
```

###Plotting frequent items (as a histogram)
```{r}
hist(Frequent)
qplot(Frequent, type = "hist")
```

###Plotting rules
```{r}
plot(Rules)
qplot(Rules)
```

## Example: Using convenience functions like `support()`

There is a set of convenience functions to access information about the rules quality directly.
```{r}
support(Frequent)[1:5]
support(Rules)[1:5]
confidence(Rules)[1:5]
lift(Rules)[1:5]
leverage(Rules)[1:5]
```

## Example: Pruning rules

In this example we will use the `Epub` dataset containing the download history of
documents from the electronical publiation platform of the Vienna University of Economics and
Business Administration.

If you want to find association rules with minimal support of 0.0009 and minimal confidence of 0.1 run:
```{r}
rules <- AssociationRules(Epub, 0.0009, 0.1)
```

If you use `qplot` you can see that there are some rules with extremely high lift values.

```{r}
qplot(rules)
```


Now imagine you are only interested in rules with a lift value above 300:
```{r}
rules_pruned <- prune(rules, Lift = 300)
print(rules_pruned)
```

Similarly, you can also prune by confidence and have a look at the rules with confidence 
of 0.75 or above:
```{r}
print(prune(rules, Confidence = 0.75))
```
